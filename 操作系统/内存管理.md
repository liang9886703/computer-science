# malloc如何分配内存的

## linux进程的内存分布

虚拟地址空间被分为内核空间和用户空间，内核空间位于高地址

<img src="image-20231227101657050.png" alt="image-20231227101657050" style="zoom:50%;" />

- 32位内核空间占用1G，位于最高处，剩下的3G是用户空间
- 64位内核空间和用户空间都是128T，中间部分未定义

32位的用户空间划分，栈区位于高地址

<img src="image-20231227102046976.png" alt="image-20231227102046976" style="zoom: 33%;" />

- 代码段，包括二进制可执行代码
- 数据段，包括已初始化的静态常量和全局变量
- BSS段，包括未初始化的静态变量和全局变量
- 堆段，动态分配的内存，从低地址向上增长
- 文件映射段，包括动态库、共享内存，从低地址向上增长
- 堆栈，包括局部变量和函数调用的上下文等，栈的大小一般固定为8MB